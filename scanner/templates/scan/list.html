<html>
    <head></head>
    <style>
      body {
        background-color: black;
        color: white;
        font-family: monospace;
      }
      input {
        padding: 10px;
        font-size: 16px;
        color: black;
        background-color: rgb(177, 167, 167);
        border: 2px solid black;
      }
      #container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        
      }
      h1 {
        font-size: 36px;
        margin-bottom: 50px;
      }
      #instrucciones {
        position: absolute;
        top: 0;
        right: 0;
        width: 25%;
        height: 78%;
        padding: 20px;
        background-color: #f0f0f0;
      }
      
      /* Add dark mode */
      @media (prefers-color-scheme: dark) {
        body {
          background-color: #1a1a1a;
          color: white;
        }
        input,
        select {
          background-color: #1a1a1a;
          color: white;
          border: 2px solid white;
        }
        #instrucciones {
          background-color: #252525;
        }
      }
    </style>
    
    <body>
      <div id="container" style="text-align:center;background-color:#1a1a1a;color:white;padding-bottom:20px;">
        <h1 style="color:#23d18b;margin-top:50px;">Distributed Ports Scanner</h1>
        <p style="color:white;">Current number of workers: {{ num_workers }}</p>
        <h2 style="color:#23d18b;margin-top:10px;">New Scan</h2>
        <div style="background-color:#111111;display:inline-block;padding:20px;border-radius:10px;margin-top:10px;">
            <form action="{% url 'scan_start' %}" method="POST">
                {% csrf_token %}
                <label for="ip" style="display:block;font-weight:bold;margin-bottom:10px;">IP/S:</label>
                <input type="text" name="ip" id="ip" style="width:100%;padding:10px;border-radius:5px;border:none;margin-bottom:20px;background-color:#1a1a1a;color:white;">
                <label for="port" style="display:block;font-weight:bold;margin-bottom:10px;">PORT/S:</label>
                <input type="text" name="port" id="port" style="width:100%;padding:10px;border-radius:5px;border:none;margin-bottom:20px;background-color:#1a1a1a;color:white;">
                <label for="scanner_type" style="display:block;font-weight:bold;margin-bottom:10px;">SCANNER TYPE:</label>
                <select name="scanner_type" id="scan_form" style="width:100%;padding:10px;border-radius:5px;border:none;margin-bottom:20px;background-color:#1a1a1a;color:white;">
                    <option value="python">PYTHON</option>
                    <option value="nmap">NMAP</option>
                </select>
                <label for="ipv_type" style="display:block;font-weight:bold;margin-bottom:10px;">IP TYPE:</label>
                <select name="ipv_type" id="ipv_form" style="width:100%;padding:10px;border-radius:5px;border:none;margin-bottom:20px;background-color:#1a1a1a;color:white;">
                    <option value="ipv4">IPV4</option>
                    <option value="ipv6">IPV6</option>
                </select>
                <input id="submit-button" type="submit" value="Start Scan" style="background-color:#23d18b;color:white;padding:10px 20px;border:none;border-radius:5px;cursor:pointer;">
            </form>
        </div>
        
        <hr style="border-top: 2px solid #23d18b;margin-top:50px;">
        <div style="background-color: #1f1f1f; color: #fff; padding: 20px; border-radius: 10px;">
          <h2 style="text-align: center; margin-bottom: 20px;">Pending Scans</h2>
          <div style="display: flex; flex-wrap: wrap; justify-content: center;">
              {% for execute in pending_scans %}
              <div style="background-color: #252526; box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2); border-radius: 5px; margin: 10px; padding: 20px; width: 300px; text-align: center;">
                  <h3 style="margin-bottom: 10px;">{{ execute.execution }}</h3>
                  <p style="margin-bottom: 10px;">Started {{ execute.created_at }}</p>
                  <ul style="list-style: none; padding: 0; margin: 0;">
                      <li>Status: {{ execute.status }}</li>
                      <li>IPV TYPE: {{ execute.ipv_type }}</li>
                      <li>SCAN TYPE: {{ execute.scanner_type }}</li>
                      <li>IP: {{ execute.ip }}</li>
                      <li>PORT: {{ execute.port }}</li>
                      <li>SCAN RESULTS: {% if execute.result %}{{ execute.result }}{% else %}Scanning...{% endif %}</li>
                  </ul>
              </div>
              {% empty %}
              <p>No pending scans.</p>
              {% endfor %}
          </div>
          <h2 style="text-align: center; margin: 40px 0 20px;">Completed Scans</h2>
          <a href="{% url 'download_all_scan_results' %}">
            <button class="btn btn-dark" style="margin-bottom: 30px;">
                <i class="fa fa-download"></i> Download All Scans Reports
            </button>
          </a>
          <div style="display: flex; flex-wrap: wrap; justify-content: center;">
              {% for execute in success_scans %}
              <div style="background-color: #252526; box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2); border-radius: 5px; margin: 10px; padding: 20px; width: 300px; text-align: center;">
                  <h3 style="margin-bottom: 10px;">{{ execute.execution }}</h3>
                  <p style="margin-bottom: 10px;">Started {{ execute.created_at }}</p>
                  <ul style="list-style: none; padding: 0; margin-bottom: 30px;">
                      <li>Status: {{ execute.status }}</li>
                      <li>IPV TYPE: {{ execute.ipv_type }}</li>
                      <li>SCAN TYPE: {{ execute.scanner_type }}</li>
                      <li>IP: {{ execute.ip }}</li>
                      <li>PORT: {{ execute.port }}</li>
                      <li>SCAN RESULTS: {{ execute.result }}</li>
                  </ul> 
                  <a href="{% url 'download_scan_results' execute.id %}">
                    <button class="btn btn-dark">
                        <i class="fa fa-download"></i> Download Report
                    </button>
                  </a>
                  </td>
              </div>
              {% empty %}
              <p>No completed scans.</p>
              {% endfor %}
          </div>
        </div>        
      </div>
      <div id="instrucciones">
        <h3>Instructions:</h3>
        <li>IP/S:</li>
        <ol>
        Enter ONE IP or IP RANGE in this format: 
          <p>Example for ONE IP of IPv4 type: 192.168.1.1
             Example for IP RANGE of IPv4 type:192.168.1.1-192.168.1.5</p>
          <p>Example for ONE IP of IPv6 type: 2001:0db8:85a3:0000:0000:8a2e:0370:7334
              Example for IP RANGE of IPv6 type: 2001:0db8:85a3:0000:0000:8a2e:0370:7334-2001:0db8:85a3:0000:0000:8a2e:0370:7335</p>
        </ol>
        <li>PORT/S:</li>
        <ol>
        Enter ONE PORT or PORT RANGE in this format:
          <p>Example for ONE PORT: 80
             Example for PORT RANGE: 80-100</p>
          <p>ATENTION: if you do not enter ports these will be by default 0-65535</p>
        </ol>
        <li>SCAN TYPE:</li>
        <ol>
        Select the type of scan you want to perform:
          <p>Python: This scan will be performed with the python script that is in the project folder.</p>
          <p>Nmap: This scan will be performed with the nmap tool.</p>
        </ol>
        <li>IP TYPE:</li>
        <ol>
        Select the type of IP you want to scan:
          <p>IPv4: This scan will be performed with the IPv4 protocol.</p>
          <p>IPv6: This scan will be performed with the IPv6 protocol.</p>
        </ol>
        <li>SCAN RESULTS:</li>
        <ol>
        The results of the scan will be displayed in the "Pending Scans" section.
        </ol>
          </div>
    </body>
</html>
