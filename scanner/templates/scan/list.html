<html>
    <head></head>
    <style>
      body {
        background-color: black;
        color: white;
        font-family: monospace;
      }
      input {
        padding: 10px;
        font-size: 16px;
        color: black;
        background-color: rgb(177, 167, 167);
        border: 2px solid black;
      }
      #container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;

      }
      h1 {
        font-size: 36px;
        margin-bottom: 50px;
      }
      #instrucciones {
        position: absolute;
        top: 0;
        right: 0;
        width: 27%;
        height: 78%;
        padding: 20px;
        background-color: #252525;
      }
      
      /* Add dark mode */
      @media (prefers-color-scheme: dark) {
        body {
          background-color: #1a1a1a;
          color: white;
        }
        input,
        select {
          background-color: #1a1a1a;
          color: white;
          border: 2px solid white;
        }
      #security {
        position: absolute;
        top: 0;
        left: 0;
        width: 27%;
        height: 78%;
        padding: 20px;
        background-color: #252525;
    }
    /* Estilo para el mensaje flash */
    .messages {
      margin: 20px 0;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 5px;
      box-shadow: 0px 0px 10px #ccc;
    }
    /* Estilo adicional para el mensaje flash en modo oscuro */
    .dark-mode .messages {
      border-color: #fff;
      box-shadow: 0px 0px 10px #fff;
    }
    }
    </style>
    <body>
      <div id="container" style="text-align:center;background-color:#1a1a1a;color:white;padding-bottom:20px;">
        {% if messages %}
        <div class="messages">
          {% for message in messages %}
            <div{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</div>
          {% endfor %}
        </div>
        {% endif %}
        <h1 style="color:#23d18b;margin-top:50px;">Distributed Ports Scanner</h1>
        <p style="color:white;">Current number of workers: {{ num_workers }}</p>
        <h2 style="color:#23d18b;margin-top:10px;">New Scan</h2>
        <div style="background-color:#111111;display:inline-block;padding:20px;border-radius:10px;margin-top:10px;">
            <form action="{% url 'scan_start' %}" method="POST">
                {% csrf_token %}
                <label for="ip" style="display:block;font-weight:bold;margin-bottom:10px;">IP/S:</label>
                <input type="text" name="ip" id="ip" style="width:100%;padding:10px;border-radius:5px;border:none;margin-bottom:20px;background-color:#1a1a1a;color:white;">
                <label for="port" style="display:block;font-weight:bold;margin-bottom:10px;">PORT/S:</label>
                <input type="text" name="port" id="port" style="width:100%;padding:10px;border-radius:5px;border:none;margin-bottom:20px;background-color:#1a1a1a;color:white;">
                <label for="scanner_type" style="display:block;font-weight:bold;margin-bottom:10px;">SCANNER TYPE:</label>
                <select name="scanner_type" id="scan_form" style="width:100%;padding:10px;border-radius:5px;border:none;margin-bottom:20px;background-color:#1a1a1a;color:white;">
                    <option value="python">PYTHON</option>
                    <option value="nmap">NMAP</option>
                </select>
                <label for="ipv_type" style="display:block;font-weight:bold;margin-bottom:10px;">IP TYPE:</label>
                <select name="ipv_type" id="ipv_form" style="width:100%;padding:10px;border-radius:5px;border:none;margin-bottom:20px;background-color:#1a1a1a;color:white;">
                    <option value="ipv4">IPV4</option>
                    <option value="ipv6">IPV6</option>
                </select>
                <input id="submit-button" type="submit" value="Start Scan" style="background-color:#23d18b;color:white;padding:10px 20px;border:none;border-radius:5px;cursor:pointer;">
            </form>
        </div>
        
        <hr style="border-top: 2px solid #23d18b;margin-top:50px;">
        <div style="background-color: #1f1f1f; color: #fff; padding: 20px; border-radius: 10px;">
          <h2 style="text-align: center; margin-bottom: 20px;">Pending Scans</h2>
          <div style="display: flex; flex-wrap: wrap; justify-content: center;">
              {% for execute in pending_scans %}
              <div style="background-color: #252526; box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2); border-radius: 5px; margin: 10px; padding: 20px; width: 300px; text-align: center;">
                  <h3 style="margin-bottom: 10px;">{{ execute.execution }}</h3>
                  <p style="margin-bottom: 10px;">Started {{ execute.created_at }}</p>
                  <ul style="list-style: none; padding: 0; margin: 0;">
                      <li>Status: {{ execute.status }}</li>
                      <li>IPV TYPE: {{ execute.ipv_type }}</li>
                      <li>SCAN TYPE: {{ execute.scanner_type }}</li>
                      <li>IP: {{ execute.ip }}</li>
                      <li>PORT: {{ execute.port }}</li>
                      <li>SCAN RESULTS: {% if execute.result %}{{ execute.result }}{% else %}Scanning...{% endif %}</li>
                  </ul>
              </div>
              {% empty %}
              <p>No pending scans.</p>
              {% endfor %}
          </div>
          <h2 style="text-align: center; margin: 40px 0 20px;">Completed Scans</h2>
          <a href="{% url 'download_all_scan_results' %}">
            <button class="btn btn-dark" style="margin-bottom: 30px;">
                <i class="fa fa-download"></i> Download All Scans Reports
            </button>
          </a>
          <div style="display: flex; flex-wrap: wrap; justify-content: center;">
              {% for execute in success_scans %}
              <div style="background-color: #252526; box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2); border-radius: 5px; margin: 10px; padding: 20px; width: 300px; text-align: center;">
                  <h3 style="margin-bottom: 10px;">{{ execute.execution }}</h3>
                  <p style="margin-bottom: 10px;">Started {{ execute.created_at }}</p>
                  <ul style="list-style: none; padding: 0; margin-bottom: 30px;">
                      <li>Status: {{ execute.status }}</li>
                      <li>IPV TYPE: {{ execute.ipv_type }}</li>
                      <li>SCAN TYPE: {{ execute.scanner_type }}</li>
                      <li>IP: {{ execute.ip }}</li>
                      <li>PORT: {{ execute.port }}</li>
                      <li>SCAN RESULTS: {{ execute.result }}</li>
                  </ul> 
                  <a href="{% url 'download_scan_results' execute.id %}">
                    <button class="btn btn-dark">
                        <i class="fa fa-download"></i> Download Report
                    </button>
                  </a>
                  </td>
              </div>
              {% empty %}
              <p>No completed scans.</p>
              {% endfor %}
          </div>
        </div>        
      </div>
      <div id="instrucciones">
        <h3>Instructions:</h3>
        <ol>
            <li>IP/S:</li>
            <ul>
                <li>Enter ONE IP or IP RANGE in this format:</li>
                <ul>
                    <li>Example for ONE IP of IPv4 type: 192.168.1.1</li>
                    <li>Example for IP RANGE of IPv4 type: 192.168.1.1-192.168.1.5</li>
                    <li>Example for ONE IP of IPv6 type: 2001:0db8:85a3:0000:0000:8a2e:0370:7334</li>
                    <li>Example for IP RANGE of IPv6 type: 2001:0db8:85a3:0000:0000:8a2e:0370:7334-<br>2001:0db8:85a3:0000:0000:8a2e:0370:7335</li>
                </ul>
            </ul>
            <li>PORT/S:</li>
            <ul>
                <li>Enter ONE PORT or PORT RANGE in this format:</li>
                <ul>
                    <li>Example for ONE PORT: 80</li>
                    <li>Example for PORT RANGE: 80-100</li>
                </ul>
                <li>ATTENTION: if you do not enter ports these will be by default 0-65535</li>
            </ul>
            <li>SCAN TYPE:</li>
            <ul>
                <li>Select the type of scan you want to perform:</li>
                <ul>
                    <li>Python: This scan will be performed with the python script that is in the project folder.</li>
                    <li>Nmap: This scan will be performed with the nmap tool.</li>
                </ul>
            </ul>
            <li>IP TYPE:</li>
            <ul>
                <li>Select the type of IP you want to scan:</li>
                <ul>
                    <li>IPv4: This scan will be performed with the IPv4 protocol.</li>
                    <li>IPv6: This scan will be performed with the IPv6 protocol.</li>
                </ul>
            </ul>
            <li>SCAN RESULTS:</li>
            <ul>
                <li>The results of the scan will be displayed in the "Pending Scans" section.</li>
            </ul>
        </ol>
      </div>
      <div id="security">
        <h3>Online Security</h3>
        <p>Port scans can be a valuable tool for identifying security vulnerabilities in a network or system, but they can also present security risks for the user. Some tips for minimizing these risks include:</p>
        <ul>
          <li>Use a firewall to block unauthorized access to your network or system.</li>
          <li>Do not use weak or easily guessable passwords.</li>
          <li>Keep software and operating systems up to date with the latest versions and security patches.</li>
          <li>Do not share sensitive information online, especially through unsecured or unknown websites.</li>
          <li>Use a secure internet connection and avoid connecting to unsecured public Wi-Fi networks.</li>
        </ul>
        <p>Remember that no system or network is completely secure, but taking proactive security measures can help minimize online security risks.</p>
        <!-- Agregar imagen -->
        <p style="text-align: center;">
          {% load static %} <img src="{% static "scan/hacker.png" %}" alt="hacker" style="height: 300px; width: 300px;" />
        </p>
      </div>
      <footer style="background-color: #000; color: #fff; padding: 10px; text-align: center;">
        <p style="margin: 0;">&copy; 2023 j0k3rD | <a href="https://github.com/j0k3rD" style="color: #fff; text-decoration: underline;">GitHub</a></p>
      </footer> 
    </body>
</html>